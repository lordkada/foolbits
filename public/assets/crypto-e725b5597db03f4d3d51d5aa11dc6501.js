!function(){var e,r,t,n,o,a,i,u,f,s,l,c;i="this is blood of soul",o=function(e){var r;return r=forge.pkcs5.pbkdf2(e,i,1e4,32)},n=function(e,r){var t;return null!=e&&null!=r?(t=new XMLHttpRequest,t.open("GET",e,!0),t.responseType="arraybuffer",t.onreadystatechange=function(){var e,n,o,a,i,f;return 4===t.readyState?(n=forge.aes.createEncryptionCipher(r,"CBC"),i=forge.random.getBytesSync(16),n.start(i),f=c(new Uint8Array(t.response)),n.update(forge.util.createBuffer(f)),n.finish(),o=n.output.data,e=new Blob([u(i),u(o)],{type:"text/plain"}),a=window.URL.createObjectURL(e),console.log("encrypted url is: "+a)):void 0},t.send()):console.log("should provide a url and a passphrase!")},t=function(e,r){var t;return t=new XMLHttpRequest,t.open("GET",e,!0),t.responseType="arraybuffer",t.onreadystatechange=function(){var e,n,o,a;return 4===t.readyState?(a=c(new Uint8Array(t.response)),o=a.slice(0,16),console.log("iv hex: "+forge.util.bytesToHex(o)),e=forge.aes.createDecryptionCipher(r,"CBC"),e.start(o),n=a.slice(16),console.log("encrypted length: "+n.length),e.update(forge.util.createBuffer(n)),e.finish(),window.open(window.URL.createObjectURL(new Blob([u(e.output.data)],{type:"binary/octet-stream"})))):void 0},t.send()},u=function(e){var r,t,n,o;for(t=new Uint8Array(e.length),r=n=0,o=e.length-1;o>=0?o>=n:n>=o;r=o>=0?++n:--n)t[r]=e.charCodeAt(r);return t},c=function(e){var r,t,n,o;for(t="",r=n=0,o=e.length-1;o>=0?o>=n:n>=o;r=o>=0?++n:--n)t+=String.fromCharCode(e[r]);return t},l=function(e){var r;return function(){var t,n,o;for(o=[],r=t=0,n=e.length-1;n>=0?n>=t:t>=n;r=n>=0?++t:--t)o.push(e[r].toString(16));return o}().join("")},r=function(e){var r,t,n,o;for(e.read=0,t=new Uint8Array(e.length()),r=n=0,o=e.length()-1;o>=0?o>=n:n>=o;r=o>=0?++n:--n)t[r]=e.getInt(1);return t},e=function(){return a(f),a(s)},a=function(e){return e()?console.log("ok"):console.log("failed")},f=function(){var e,r,t,n,o;for(n=o=0;999>=o;n=++o)if(e=forge.random.getBytesSync(16),r=forge.util.bytesToHex(e),t=forge.util.bytesToHex(c(u(e))),r!==t)return console.log("Error: "+r+" -- NOT EQUAL -> "+t),!1;return!0},s=function(){var e,t,n,o,a;for(o=a=0;999>=a;o=++a)if(e=forge.random.getBytesSync(16),t=forge.util.bytesToHex(e),n=forge.util.bytesToHex(c(r(forge.util.createBuffer(e)))),t!==n)return console.log("Error: "+t+" -- NOT EQUAL -> "+n),!1;return!0},window.generate_key=o,window.encrypt=n,window.decrypt=t,window.all_tests=e,window.uint8array_to_string=c,window.buffer_to_uint8array=r,window.string_to_uint8array=u,window.uint8array_to_hex=l}.call(this);