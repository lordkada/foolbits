!function(){function e(e){function t(e,t,n){for(var i="",r=Math.ceil(t/n.digestLength),g=0;r>g;++g){var s=String.fromCharCode(255&g>>24,255&g>>16,255&g>>8,255&g);n.start(),n.update(e+s),i+=n.digest().getBytes()}return i.substring(0,t)}var n=e.pkcs1=e.pkcs1||{};n.encode_rsa_oaep=function(n,i,r){var g=void 0,s=void 0,d=void 0;"string"==typeof r?(g=r,s=arguments[3]||void 0,d=arguments[4]||void 0):r&&(g=r.label||void 0,s=r.seed||void 0,d=r.md||void 0),d?d.start():d=e.md.sha1.create();var o=Math.ceil(n.n.bitLength()/8),a=o-2*d.digestLength-2;if(i.length>a)throw{message:"RSAES-OAEP input message length is too long.",length:i.length,maxLength:a};g||(g=""),d.update(g,"raw");for(var h=d.digest(),l="",u=a-i.length,f=0;u>f;f++)l+="\0";var c=h.getBytes()+l+""+i;if(s){if(s.length!==d.digestLength)throw{message:"Invalid RSAES-OAEP seed. The seed length must match the digest length.",seedLength:s.length,digestLength:d.digestLength}}else s=e.random.getBytes(d.digestLength);var v=t(s,o-d.digestLength-1,d),p=e.util.xorBytes(c,v,c.length),m=t(p,d.digestLength,d),y=e.util.xorBytes(s,m,s.length);return"\0"+y+p},n.decode_rsa_oaep=function(n,i,r){var g=void 0,s=void 0;"string"==typeof r?(g=r,s=arguments[3]||void 0):r&&(g=r.label||void 0,s=r.md||void 0);var d=Math.ceil(n.n.bitLength()/8);if(i.length!==d)throw{message:"RSAES-OAEP encoded message length is invalid.",length:i.length,expectedLength:d};if(void 0===s?s=e.md.sha1.create():s.start(),d<2*s.digestLength+2)throw{message:"RSAES-OAEP key is too short for the hash function."};g||(g=""),s.update(g,"raw");for(var o=s.digest().getBytes(),a=i.charAt(0),h=i.substring(1,s.digestLength+1),l=i.substring(1+s.digestLength),u=t(l,s.digestLength,s),f=e.util.xorBytes(h,u,h.length),c=t(f,d-s.digestLength-1,s),v=e.util.xorBytes(l,c,l.length),p=v.substring(0,s.digestLength),m="\0"!==a,y=0;y<s.digestLength;++y)m|=o.charAt(y)!==p.charAt(y);for(var L=1,A=s.digestLength,S=s.digestLength;S<v.length;S++){var b=v.charCodeAt(S),E=1^1&b,x=L?65534:0;m|=b&x,L&=E,A+=L}if(m||1!==v.charCodeAt(A))throw{message:"Invalid RSAES-OAEP padding."};return v.substring(A+1)}}var t="pkcs1";if("function"!=typeof define){if("object"!=typeof module||!module.exports)return"undefined"==typeof forge&&(forge={}),e(forge);var n=!0;define=function(e,t){t(require,module)}}var i,r=function(n,r){r.exports=function(r){var g=i.map(function(e){return n(e)}).concat(e);if(r=r||{},r.defined=r.defined||{},r.defined[t])return r[t];r.defined[t]=!0;for(var s=0;s<g.length;++s)g[s](r);return r[t]}},g=define;define=function(e,t){return i="string"==typeof e?t.slice(2):e.slice(2),n?(delete define,g.apply(null,Array.prototype.slice.call(arguments,0))):(define=g,define.apply(null,Array.prototype.slice.call(arguments,0)))},define(["require","module","./util","./random","./sha1"],function(){r.apply(null,Array.prototype.slice.call(arguments,0))})}();